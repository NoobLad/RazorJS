/*
  RazorJS 0.2.2 <https://github.com/andyedinborough/RazorJS>
  Copyright (c) 2013 Andy Edinborough (@andyedinborough)
  Released under MIT License
*/
!function(a,b,c){"use strict";function d(a){return a&&(a+"").indexOf("[native code]")>-1?a:void 0}function e(a){return o(arguments,function(b,c){0!==c&&b&&o(s(b),function(c){a[c]=b[c]})}),a}function f(a){var b=a.indexOf("{");return a.substr(0,b+1)+"\r\n"+a.substring(b+1,a.lastIndexOf("}"))+'; return ""; }'}function g(a){return a.split("\\").join("\\\\").split("\r").join("\\r").split("\n").join("\\n").split('"').join('\\"')}function h(a){return{toString:function(){return a},isHtmlString:!0}}function i(a){return(a=a||"").substr(a.length-1)}function j(a){var b,c,d,e=new u(a),g=arguments[1]||0,h=arguments[2]||0,k=[],l=[],m=[],n=function(){if(c=e.peek(),"*"===c)e.readUntil("*@");else if("("===c)d=e.readBlock("(",")"),k.push(d.substr(1,d.length-2),1);else if("{"===c)d=e.readBlock("{","}"),k.push(j(d.substr(1,d.length-2),g+1,1).join("\n"));else if(":"===c&&1===h){for(d=e.readUntil("\n","@","}");"@"===d.next&&"@"===e.peek();){var a=e.readUntil("\n","@","}");d.value+=a.value,d.next=a.next}e.seek(-1),d.value=d.value.substr(1),k.push(d.value,2)}else if("i"===c&&"if"===e.peek(2)||"d"===c&&"do"===e.peek(2)||"f"===c&&"for"===e.peek(3)||"w"===c&&"while"===e.peek(5)||"h"===c&&"helper"===e.peek(6)||"s"===c&&"section"===e.peek(7)){if(d=e.readBlock("{","}"),"i"===c)for(;!e.eof();){var f=e.readWhitespace();if(!f)break;if("else"!==e.peek(4)){e.seek(-f.length);break}d+=f+e.readBlock("{","}")}var n=j(d.substr(0,d.length-1),g+1,1).join("\r\n	")+"}",o=n.indexOf("("),p=n.indexOf("{");(-1===o||o>p)&&(o=p),"h"===c?l.push("function "+n.substr(7)):"s"===c?m.push("page.sections."+n.substr(8,o-8)+" = function () {"+"var writer = [], writeLiteral = function(a) { writer.push(a); }, write = function(a){ writeLiteral(page.html.encode(a)); };\n"+n.substr(p+1).replace(/}$/g,"")+'\nreturn writer.join("");\n}\n'):k.push(n)}else if(c&&!v.test(i(b.value))){var q,r;for(d="";!e.eof()&&(q=e.text.substr(e.position+1),r=q.match(v))&&(d+=e.read(r[0].length),c=e.peek());)if("["===c||"("===c){d+=e.readBlock(c,"["===c?"]":")");break}d&&k.push(d,1)}else 0===h&&b.next&&k.push("@",2)};for(k.push=function(a){return function(b,c){"string"==typeof b&&(b=[b]),b=p(b,function(a){return"undefined"!=typeof a.code?a:new x(a,c)}),a.apply(this,b)}}(k.push);!e.eof()&&(b=0===h?e.readUntil("@"):e.readQuotedUntil("@","<"));){for(;;){if(c=e.peek(),"@"===c&&(b.value+=e.read()),1===h&&"<"===b.next){var o=!1,q=(e.text.substr(e.position+1,30).match(w)||0)[0]||"";if(!q){var r=e.readQuotedUntil("@","<");b.value+=b.next+r.value,b.next=r.next;continue}for(k.push(b.value,0);!e.eof()&&(b=e.readUntil("@",">"),"@"==b.next);)k.push((o?"":"<")+b.value,2),o=!0,n();if(d=b+"","/"!==i(b.value)){for(var s,t=1;t>0&&(s=e.readQuotedUntil(["</"+q,"<"+q]),d+=s,!e.eof());)t+="/"===s.next.substr(1,1)?-1:1;d+=e.readQuotedUntil(">")}o||(d="text"===q?d.substr(5,d.length-5-7):"<"+d),k.push(j(d,g+1,0))}else b.value&&(0===h?k.push(b.value,2):k.push(b.value));break}n()}return g>0?k:(a=k.join("\r\n"),a=y.replace("@code",p(l,f).join("\r\n")+"\r\n"+p(m,f).join("\r\n")+a))}function k(a){return(null===a||a===c)&&(a=""),a.isHtmlString?a:("string"!=typeof a&&(a+=""),a=a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;"),h(a))}function l(b,d){var f,g=j(b);try{f=new Function("bind","undefined",g)}catch(i){throw a.console.error(i.message+": "+g),i.message+": "+g}return function k(a,b,g){if(!g&&"function"==typeof b)return k(a,null,b);var i=e({viewBag:{}},A,d,b,{model:a});i.html=new z,i.html.page=i,i.html.model=a;var j=f.apply(i,[t]);if(i.layout){var l=function(a){var b=a(null,{renderBody:function(){return h(j)},viewBag:i.viewBag,isSectionDefined:function(a){return"function"==typeof i.sections[a]},renderSection:function(a,b){if(this.isSectionDefined(a)){var c=h(i.sections[a]());return c}if(b)throw'Section "'+a+'" not found.'}},g);g||(j=b)},m=D.view(i.layout,null,g?l:c);g||l(m)}return g?void 0:j}}function m(a,b,d){if(!d&&"function"==typeof b)return m(a,c,b);var e="~/"+a,f=B[e],g=C[e],h=D.getViewEtag(a);if(!f||h!==g||D.cacheDisabled){var i=function(a){a&&(f=B[e]=D.compile(a,b),C[e]=h),d&&d(f)};return f=D.findView(a,d?i:null),d||i(f),f}return d?(d(f),void 0):f}var n=function(a){return function(b,c){return a.apply(b,[c])}},o=n(d(Array.prototype.forEach)||function(b,c){for(var d,e=this.length,f=e,g=c||a;f--;)b.apply(g,[this[d=e-f-1],d])}),p=n(d(Array.prototype.map)||function(b,c){for(var d=c||a,e=[],f=0,g=this.length;g>f;++f)e.push(b.call(d,this[f],f,this));return e}),q=n(d(Array.prototype.some)||function(b,c){for(var d=c||a,e=0,f=this.length;f>e;++e)if(b.call(d,this[e],e,this))return!0;return!1}),r="toString valueOf".split(" "),s=d(Object.keys)||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return o(r,function(c){a[c]!==Object.prototype[c]&&b.push(c)}),b},t=n(Function.prototype.bind||function(a,b){return function(){return a.apply(b,arguments)}}),u=function(){function a(a,b,c){function e(b){return f=b.length,j=g[f]||(g[f]=a.peek(f)),j===b}for(var f,g=[],h="",j="";!a.eof();){if(g.length=0,c===q(b,e))return c?a.seek(f):(j=i(h),h=h.length>0?h.substr(0,h.length-1):""),d.create(h,j);if(j=a.read(),!j)break;h+=j}return d.create(h,j)}var b=function(a){this.text=(a||"")+"",this.position=-1,this.length=this.text.length},d=b.Chunk=function(a,b){return this.value=a||"",this.next=b||"",a||b?(this.length=(this.value+this.next).length,void 0):""};return e(d.prototype,{length:0,toString:function(){return this.value+this.next+""}}),d.create=function(a,b){return a||b?new d(a,b):""},e(b.prototype,{eof:function(){return this.position>=this.length},read:function(a){var b=this.peek(a);return this.position=Math.min(this.length,this.position+(a||1)),b},readAll:function(){if(this.position>=this.length)return c;var a=this.text.substr(this.position+1);return this.position=this.length,a},peek:function(a){return this.position+1>=this.length?c:this.text.substr(this.position+1,a||1)},seek:function(a,b){return this.position=Math.max(0,Math.min(this.length,(0===b?0:2===b?this.length:this.position)+(a||1))),this.position===this.length},readUntil:function(b){return"string"==typeof b&&(b=[].slice.call(arguments)),a(this,b,!0)},readWhile:function(b){return"string"==typeof b&&(b=[].slice.call(arguments)),a(this,b,!1)}}),b}(),v=/^[a-z0-9\._]+/i,w=/^[a-z]+(?:\:[a-z]+)?/i;u.prototype.readWhitespace=function(){return this.readWhile("\r","\n","	"," ")},u.prototype.readQuoted=function(a){for(var b,c="";;){if(b=this.readUntil(a),!b)break;if(c+=b.value+b.next,"\\"!==i(b.value))break}return c},u.prototype.readQuotedUntil=function(a){var b,c="";for("string"==typeof a&&(a=[].slice.call(arguments)),a=['"',"'","@*"].concat(a);b=this.readUntil(a);)if(c+=b.value,'"'===b.next||"'"===b.next)c+=b.next+this.readQuoted(b.next);else{if("@*"!==b.next)break;this.readUntil("*@")}return u.Chunk.create(c,b.next)},u.prototype.readBlock=function(a,b,c){var d,e=[a,b],f="";for(c=c||0;d=this.readUntil(e);){if(f+=d.value,d.next===a?c++:d.next===b&&c--,0===c)return f+=d.next;f+=d.next}return f};var x=function(a,b){this.code=a||"",this.type=b||0};e(x.prototype,{type:0,code:"",toString:function(){var a=this.code;return 0===this.type?a:2===this.type?'writeLiteral("'+g(a)+'");':"write("+a+");"}});var y='"use strict";\nvar writer = [], page = this, model = page.model, viewBag = this.viewBag, html = this.html,\n	isSectionDefined = this.isSectionDefined ? bind(this.isSectionDefined, this) : undefined,\n	renderSection = this.renderSection ? bind(this.renderSection, this) : undefined,\n	renderBody = this.renderBody ? bind(this.renderBody, this) : undefined,\n	writeLiteral = function(a){ writer.push(a); }, write = function(a){ writeLiteral(html.encode(a)); },\n	_layout = this.layout, layout;\n@code\nif(_layout !== layout) { this.layout = layout; }\nreturn writer.join("");\n',z=function(){};e(z.prototype,{encode:k,attributeEncode:function(a){return k(a)},raw:function(a){return h(a)},renderPartial:function(a,b,c){return h(D.view(a)(b,c||this.page))}});var A={html:new z,sections:{}},B={},C={},D={view:m,compile:l,parse:j,findView:null,basePage:A,Cmd:x,extend:e,bind:t,render:function(a,b,c,d){var e;return l(a)(b,c,function(a){e=a,d&&d(e)}),e},getViewEtag:null,views:B,etags:C,cacheDisabled:!1},E=a.document.getElementsByTagName("script");D.findView=function(a,b){for(var c,d=0,e=E.length;e>d&&(c=E[d]);d++)if("application/x-razor-js"===c.type&&c.getAttribute("data-view-id")===a)return"function"==typeof b&&b(c.innerHTML),c.innerHTML},D.getViewEtag=function(a){return a},a.Razor=D}(window);