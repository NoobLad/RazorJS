(function(){function e(a){return(a=a||"")[a.length-1]||""}function h(a,b){var k=new c(a),l=arguments[1]||0,m=arguments[2]||0,n=[],o=[],p=[],q,r,s;n.push=function(a){return function(b,c){typeof b=="string"&&(b=[b]),b=b.map(function(a){return a instanceof f?a:f(a,c)}),a.apply(this,b)}}(n.push);for(;;){q=m===0?k.readUntil("@"):k.readQuotedUntil("@","<");if(!q||!q.value&&!q.next)break;r=k.peek(),r==="@"&&(q.value+=k.read()),q.value&&(m===0?n.push(q.value,2):n.push(q.value));if(m===1&&q.next==="<"){var t=k.text.substr(k.position+1).match(/^[a-z]+/i);t&&(q=k.readUntil(">"),s=q+"",e(q.value)!=="/"&&(s+=k.readUntil("</"+t+">")),n.push(h("<"+s,l+1,0)))}if(r==="*")k.readUntil("*@");else if(r==="(")s=k.readBlock("(",")"),n.push(s.substr(1,s.length-2),1);else if(r==="{")s=k.readBlock("{","}"),n.push(h(s.substr(0,s.length-1),l+1,1).join("\n")+"}");else if(r===":"&&m===1){s=k.readUntil("\n","@");while(s.next==="@"&&k.peek(1)==="@"){var u=k.readUntil("\n","@");s.value+=u.value,s.next=u.next}s.value=s.value.substr(1),n.push(s.value.match(/(.*?)\s*$/)[1],2),n.push(s.value.match(/\s*$/)[0]||"",0)}else if(r==="i"&&k.peek(2)==="if"||r==="d"&&k.peek(2)==="do"||r==="f"&&k.peek(3)==="for"||r==="w"&&k.peek(5)==="while"||r==="h"&&k.peek(6)==="helper"||r==="7"&&k.peek(7)==="section"){s=k.readBlock("{","}");if(r==="i")for(;;){var v=k.readWhitespace();if(!v)break;if(k.peek(4)!=="else"){k.seek(-v.length);break}s+=v+k.readBlock("{","}")}var w=h(s.substr(0,s.length-1),l+1,1).join("\n")+"}";r==="h"?o.push("function "+w.substr(7)):r==="s"?p.push("function _section_"+w.substr(8)):n.push(w)}else if(r&&!d.test(e(q.value))){var x,y;s="";for(;;){x=k.text.substr(k.position+1),y=x.match(d);if(!y)break;s+=k.read(y[0].length),r=k.peek();if(r==="["||r==="(")s+=k.readBlock(r,r==="["?"]":")")}s&&n.push(s,1)}else m===0&&q.next&&n.push("@",2)}return b!==!1&&(n.reduce(function(a,b){if(a.type===2&&b.type===2)a.code+=b.code;else if(a.type===2&&b.type===1)a.code='"'+j(a.code)+'"+('+b.code+")",a.type=1;else if(a.type==1&&b.type===1)a.code+="+("+b.code+")";else{if(a.type!==1||b.type!==2)return b;e(a.code)==='"'?a.code=a.code.substr(0,a.code.length-1):a.code+='+"',a.code+=j(b.code)+'"'}return b.code="",a}),n=n.filter(function(a){return!!a.code})),l>0?n:(a=n.join("\r\n"),a=g.replace("#0",a).replace("#1",o.map(i).join("\r\n")).replace("#2",p.map(i).join("\r\n")),a)}function i(a){var b=a.indexOf("{");return a.substr(0,b+1)+" with (page) {\r\n"+a.substring(b+1,a.lastIndexOf("}"))+'; return ""; } }'}function j(a){return a.split("\r").join("\\r").split("\n").join("\\n").split('"').join('\\"')}function k(a,b,c){var d,e=h(a,c);try{d=new Function(e)}catch(f){throw f.message+": "+e}return function(a,c){var e=l({},b,c,{model:a});return d.apply(e)}}function l(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];if(d)for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function o(b,c){var d=n["~/"+b],e=m();return d?e.resolve(d):a.findView(b).done(function(f){f&&(d=n["~/"+b]=a.compile(f,c)),e.resolve(d)}),e}function p(a){var c,d=m();return[].slice.call(b.document.getElementsByTagName("script")).some(function(b){return b.type==="application/x-razor-js"&&b.getAttribute("data-view-id")===a&&(c=b)}),d.resolve(c?c.innerHTML:undefined),d}function q(a){var c=module.require("fs"),d=m();return a.substring(a.lastIndexOf("."))!==".jshtml"&&(a+=".jshtml"),c.readFile(a,"ascii",function(a,c){a&&(console.error("Could not open file: %s",a),b.process.exit(1)),d.resolve(c.toString("ascii"))}),d}"use strict";var a,b=(new Function("return this"))(),c=function(){function c(a,c,d){function k(b){return f=b.length,j=g[f]||(g[f]=a.peek(f)),j===b}var f,g=[],h=c.length,i="",j="";for(;;){g.length=0;if(d===c.some(k))return d?a.seek(f):(j=e(i),i=i.length>0?i.substr(0,i.length-1):""),b(i,j);j=a.read();if(!j)break;i+=j}return b(i,j)}var a=function(a){this.text=(a||"")+"",this.position=-1,this.length=this.text.length},b=a.Chunk=function(b,c){if(!this||this.length!==0)return new a.Chunk(b,c);this.value=b||"",this.next=c||"",this.length=(this.value+this.next).length};return a.Chunk.prototype.length=0,a.Chunk.prototype.toString=function(){return this.value+this.next+""},a.prototype.read=function(a){var b=this.peek(a);return this.position=Math.min(this.length,this.position+(a||1)),b},a.prototype.readAll=function(){if(this.position>=this.length)return undefined;var a=this.text.substr(this.position+1);return this.position=this.length,a},a.prototype.peek=function(a){return this.position+1>=this.length?undefined:this.text.substr(this.position+1,a||1)},a.prototype.seek=function(a,b){return this.position=Math.max(0,Math.min(this.length,(b===0?0:b===2?this.length:this.position)+(a||1))),this.position===this.length},a.prototype.readUntil=function(a){return typeof a=="string"&&(a=[].slice.call(arguments)),c(this,a,!0)},a.prototype.readWhile=function(a){return typeof a=="string"&&(a=[].slice.call(arguments)),c(this,a,!1)},a}(),d=/^[a-z0-9\._]+/i;c.prototype.readWhitespace=function(){return this.readWhile("\r","\n","	"," ")},c.prototype.readQuoted=function(a){var b="",c;for(;;){c=this.readUntil(a);if(!c)break;b+=c.value+c.next;if(e(c.value)!=="\\")break}return b},c.prototype.readQuotedUntil=function(a){var b="",d;typeof a=="string"&&(a=[].slice.call(arguments)),a=['"',"'","@*"].concat(a);while(d=this.readUntil(a)){b+=d.value;if(d.next==='"'||d.next==="'")b+=d.next+this.readQuoted(d.next);else{if(d.next!=="@*")break;this.readUntil("*@")}}return c.Chunk(b,d.next)},c.prototype.readBlock=function(a,b,c){var d,e=[a,b],f="";c=c||0;while(d=this.readUntil(e)){f+=d.value,d.next===a?c++:d.next===b&&c--;if(c===0)return f+=d.next,f;f+=d.next}return f};var f=function r(a,b){if(!this||this.type!==0)return new r(a,b);this.code=a||"",this.type=b||0};l(f.prototype,{type:0,toString:function(){var a=this.code;return this.type===0?a:(this.type===2&&(a='"'+j(a)+'"'),"write("+a+");")}});var g='var page = this, writer = []; \r\nfunction write(txt){ writer.push(txt); }\r\n#1\r\n#2\r\nwith(page){\r\n#0\r\n}\r\nreturn writer.join("");',m=function s(){if(!(this instanceof s))return new s;var a=[],b=[],c=[],d=0,e=this,f,g=function(a,b){var c;while(b&&(c=a.shift()))c.apply(e,f)};l(e,{done:function(c){return c&&a.push(c),g(a,d===1),g(b,d!==0),e},always:function(a){return b.push(a),g(b,d!==0),e},fail:function(a){return a&&c.push(a),g(c,d===-1),g(b,d!==0),e},resolve:function(){return f=arguments,d===0&&(d=1),e.done()},reject:function(){return f=arguments,d===0&&(d=-1),e.fail()}})},n={};a={view:o,compile:k,parse:h,findView:b.document?p:q,render:function(a,b,c){return k(a,c)(b)}},module&&module.exports?module.exports=a:b.Razor=a})()